# E-Commerce Microservices

Микросервисная архитектура для системы электронной коммерции, реализующая паттерн Saga для обеспечения согласованности данных между сервисами.

## Архитектура

Система состоит из следующих микросервисов:

### Order Service
- **Назначение**: Управление заказами пользователей
- **API**:
  - `CreateOrder` - создание нового заказа
  - `GetOrder` - получение информации о заказе
  - `CancelOrder` - отмена заказа

### Orchestrator Service
- **Назначение**: Координация саги заказа, отслеживание выполнения шагов транзакции
- **API**:
  - `GetOrderSaga` - получение информации о саге заказа и её шагах

### Payment Service
- **Назначение**: Управление платежами и резервированием средств пользователя
- **API**:
  - `ReserveUserBalance` - резервирование средств на счете пользователя
  - `CompensateUserBalance` - компенсация (отмена резервирования) средств

### Stock Service
- **Назначение**: Управление инвентарем и резервированием товаров
- **API**:
  - `ReserveItem` - резервирование товара
  - `CompensateItem` - компенсация (отмена резервирования) товара

## Процесс обработки заказа

1. Пользователь создает заказ через Order Service
2. Order Service запускает сагу через Orchestrator
3. Orchestrator координирует последовательные шаги:
   - Резервирование товара в Stock Service
   - Резервирование средств в Payment Service
4. В случае успеха всех шагов, заказ подтверждается
5. В случае сбоя на любом шаге, выполняются компенсирующие операции для отмены предыдущих шагов

## Статусы саги

- `PENDING` - сага в процессе выполнения
- `COMPLETED` - сага успешно завершена
- `FAILED` - сага завершилась с ошибкой
- `COMPENSATED` - выполнена компенсация шагов саги

## Технологии

- Go
- gRPC/REST API
- PostgreSQL
- Docker